<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Random field and latent models • inlabruCourseMay2025</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Random field and latent models">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">inlabruCourseMay2025</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-installation" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Installation</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-installation">
<li><a class="dropdown-item" href="../articles/install.html">Software installation</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-notes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Notes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-notes">
<li><a class="external-link dropdown-item" href="http://www.maths.ed.ac.uk/~flindgre/inlabruCourseMay2025/inlabruCourseMay2025.pdf">Handwritten notes (pdf) (updated during breaks)</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_notes.html">Random field and latent models</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials-day-" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials Day 1</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials-day-">
<li><h6 class="dropdown-header" data-toc-skip>Random fields</h6></li>
    <li><a class="dropdown-item" href="../articles/random_fields_1d.html">1D models</a></li>
    <li><a class="dropdown-item" href="../articles/random_fields_2d.html">2D models</a></li>
    <li><a class="dropdown-item" href="../articles/aggregated_counts_1d.html">Aggregated count models</a></li>
    <li><a class="dropdown-item" href="../articles/nonseparable_spacetime.html">Non-separable covariance</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials-day-" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials Day 2</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials-day-">
<li><a class="external-link dropdown-item" href="https://inlabru-org.github.io/inlabru/articles/2d_lgcp.html">Poisson Point processes</a></li>
    <li><a class="external-link dropdown-item" href="https://inlabru-org.github.io/inlabru/articles/2d_lgcp_distancesampling.html">Distance sampling transect surveys</a></li>
    <li><a class="dropdown-item" href="../articles/lgcp_2d_covars.html">Spatial covariates</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/lgcp_2d_spatiotemporal.html">Spatio-temporal point processes</a></li>
    <li><a class="external-link dropdown-item" href="https://inlabru-org.github.io/inlabru/articles/zip_zap_models.html">Multi-likelihood models; zero-inflated models</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="external-link dropdown-item" href="https://inlabru-org.github.io/inlabru/articles/prediction_scores.html">Predictive model assessment</a></li>
    <li><a class="external-link dropdown-item" href="https://inlabru-org.github.io/inlabru/articles/svc.html">Spatially varying coefficients</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/inlabru-org/inlabruCourseMay2025/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Random field and latent models</h1>
                        <h4 data-toc-skip class="author">Finn
Lindgren</h4>
            
            <h4 data-toc-skip class="date">2025-05-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/inlabru-org/inlabruCourseMay2025/blob/main/vignettes/lecture_notes.Rmd" class="external-link"><code>vignettes/lecture_notes.Rmd</code></a></small>
      <div class="d-none name"><code>lecture_notes.Rmd</code></div>
    </div>

    
    
<p>The main references to the INLA method and the inlabru software
are</p>
<ul>
<li><a href="#ref-rue2009inla"><span class="citation">Rue, Martino, and
Chopin (2009)</span></a></li>
<li><a href="#ref-bachl2019inlabru"><span class="citation">Bachl et al.
(2019)</span></a></li>
<li>
<a href="#ref-lindgren2024inlabrusoftwarefittinglatent"><span class="citation">Finn Lindgren et al. (2024)</span></a> (currently being
revised)</li>
</ul>
<p>The main references to the stochastic PDE method for constructing
stationary and non-stationary continuous domain random field models
represented by Gaussian Markov random fields are</p>
<ul>
<li><a href="#ref-lindgren2011spde"><span class="citation">Finn
Lindgren, Rue, and Lindström (2011)</span></a></li>
<li><a href="#ref-lindgren2022spde10years"><span class="citation">Finn
Lindgren, Bolin, and Rue (2022)</span></a></li>
<li><a href="#ref-lindgren2024spacetime"><span class="citation">F.
Lindgren et al. (2024)</span></a></li>
</ul>
<div class="section level2">
<h2 id="spatial-dependence-structures">Spatial dependence structures<a class="anchor" aria-label="anchor" href="#spatial-dependence-structures"></a>
</h2>
<div class="section level3">
<h3 id="independent-gaussians">Independent Gaussians<a class="anchor" aria-label="anchor" href="#independent-gaussians"></a>
</h3>
</div>
<div class="section level3">
<h3 id="graph-dependent-structures-markov-random-fields">Graph dependent structures; Markov random fields<a class="anchor" aria-label="anchor" href="#graph-dependent-structures-markov-random-fields"></a>
</h3>
<div class="section level4">
<h4 id="discrete-variables">Discrete variables<a class="anchor" aria-label="anchor" href="#discrete-variables"></a>
</h4>
</div>
<div class="section level4">
<h4 id="continuous-variables-gaussian-mrfs">Continuous variables; Gaussian MRFs<a class="anchor" aria-label="anchor" href="#continuous-variables-gaussian-mrfs"></a>
</h4>
<p>Covariance and Precision matrices</p>
<p>Multivariate vectors with covariance and precision representation of
the dependence: <span class="math display">\[
\begin{aligned}
u &amp;\sim N(\mu_u,\Sigma_u) \\
u &amp;\sim N(\mu_u,Q_u^{-1})
\end{aligned}
\]</span> Observations with additive noise: <span class="math display">\[
y|u \sim N(\eta = b + A u, Q_\epsilon^{-1})
\]</span> Joint covariance: <span class="math display">\[
\Sigma_{(u,y)} =
\begin{bmatrix}
\Sigma_u &amp; \Sigma_u A^\top \\
A^\top \Sigma_u &amp; A \Sigma_u A^\top + Q_\epsilon^{-1}
\end{bmatrix}
\]</span></p>
<p>Joint precision: <span class="math display">\[
Q_{(u,y)} =
\begin{bmatrix}
Q_u + A^\top Q_\epsilon A &amp; -A^\top Q_\epsilon \\
-Q_\epsilon A &amp; Q_\epsilon
\end{bmatrix}
\]</span></p>
<p>Conditional distributions: <span class="math display">\[
\begin{aligned}
u|y &amp;\sim N(\mu_{u|y},\Sigma_{u|y}) \\
\Sigma_y &amp;= A \Sigma_u A^\top + Q_\epsilon^{-1} \\
\Sigma_{u|y} &amp;=
\Sigma_u - \Sigma_u A^\top \Sigma_y^{-1} A
\Sigma_u \\
\mu_{u|y} &amp;= \mu_u + \Sigma_u A^\top \Sigma_y^{-1} (y - b - A \mu_u)
\\
\end{aligned}
\]</span> and <span class="math display">\[
\begin{aligned}
u|y &amp;\sim N(\mu_{u|y},Q_{u|y}^{-1}) \\
Q_{u|y} &amp;= Q_u + A^\top Q_\epsilon A \\
\mu_{u|y} &amp;= \mu_u + Q_{u|y}^{-1} A^\top Q_\epsilon (y - b - A
\mu_u)
\end{aligned}
\]</span></p>
</div>
</div>
<div class="section level3">
<h3 id="gaussian-processesrandom-fields">Gaussian processes/random fields<a class="anchor" aria-label="anchor" href="#gaussian-processesrandom-fields"></a>
</h3>
<div class="section level4">
<h4 id="covariance-functions">Covariance functions<a class="anchor" aria-label="anchor" href="#covariance-functions"></a>
</h4>
</div>
<div class="section level4">
<h4 id="precision-operators-spdes-and-gmrfs">Precision operators; SPDEs and GMRFs<a class="anchor" aria-label="anchor" href="#precision-operators-spdes-and-gmrfs"></a>
</h4>
</div>
<div class="section level4">
<h4 id="basis-function-representations">Basis function representations<a class="anchor" aria-label="anchor" href="#basis-function-representations"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_mesh_1d.html" class="external-link">fm_mesh_1d</a></span><span class="op">(</span></span>
<span>  loc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  degree <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; fm_mesh_1d object:</span></span>
<span><span class="co">#&gt;   Manifold:  R1</span></span>
<span><span class="co">#&gt;   #{knots}:  10</span></span>
<span><span class="co">#&gt;   Interval:  (0, 1)</span></span>
<span><span class="co">#&gt;   Boundary:  (neumann, neumann)</span></span>
<span><span class="co">#&gt;   B-spline degree:   2</span></span>
<span><span class="co">#&gt;   Basis d.o.f.:  9</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/geom_fm.html" class="external-link">geom_fm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">m</span><span class="op">)</span></span></code></pre></div>
<p><img src="lecture_notes_files/figure-html/unnamed-chunk-1-1.png" width="672"></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_mesh_1d.html" class="external-link">fm_mesh_1d</a></span><span class="op">(</span><span class="va">m</span><span class="op">$</span><span class="va">mid</span>, degree <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; fm_mesh_1d object:</span></span>
<span><span class="co">#&gt;   Manifold:  R1</span></span>
<span><span class="co">#&gt;   #{knots}:  9</span></span>
<span><span class="co">#&gt;   Interval:  (0.05555556, 0.94444444)</span></span>
<span><span class="co">#&gt;   Boundary:  (neumann, neumann)</span></span>
<span><span class="co">#&gt;   B-spline degree:   1</span></span>
<span><span class="co">#&gt;   Basis d.o.f.:  9</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/geom_fm.html" class="external-link">geom_fm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">m</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/geom_fm.html" class="external-link">geom_fm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">m1</span>, xlim <span class="op">=</span> <span class="va">m</span><span class="op">$</span><span class="va">interval</span><span class="op">)</span></span></code></pre></div>
<p><img src="lecture_notes_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/geom_fm.html" class="external-link">geom_fm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">m</span>, weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_dof.html" class="external-link">fm_dof</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, knots <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="lecture_notes_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<p>Changing the knot sequence but keeping the weights independent
drastically changes the model.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">m_dense</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_mesh_1d.html" class="external-link">fm_mesh_1d</a></span><span class="op">(</span></span>
<span>  loc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span>,</span>
<span>  degree <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; fm_mesh_1d object:</span></span>
<span><span class="co">#&gt;   Manifold:  R1</span></span>
<span><span class="co">#&gt;   #{knots}:  100</span></span>
<span><span class="co">#&gt;   Interval:  (0, 1)</span></span>
<span><span class="co">#&gt;   Boundary:  (neumann, neumann)</span></span>
<span><span class="co">#&gt;   B-spline degree:   2</span></span>
<span><span class="co">#&gt;   Basis d.o.f.:  99</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/geom_fm.html" class="external-link">geom_fm</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">m_dense</span>,</span>
<span>    weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_dof.html" class="external-link">fm_dof</a></span><span class="op">(</span><span class="va">m_dense</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    knots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    basis <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="lecture_notes_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<p>The SPDE approach provides a method for constructing basis weight
dependence structures that are consistent when changing the knot
sequence and/or the basis functions, by projecting a continuously
defined process model onto the function space defined by any given set
of basis functions. The main requirement is that the basis functions
need to be able to resolve features down to a certain scale, as
determined by the correlation length of the process model.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">m_dense2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_mesh_1d.html" class="external-link">fm_mesh_1d</a></span><span class="op">(</span></span>
<span>  loc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>,</span>
<span>  degree <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; fm_mesh_1d object:</span></span>
<span><span class="co">#&gt;   Manifold:  R1</span></span>
<span><span class="co">#&gt;   #{knots}:  1000</span></span>
<span><span class="co">#&gt;   Interval:  (0, 1)</span></span>
<span><span class="co">#&gt;   Boundary:  (neumann, neumann)</span></span>
<span><span class="co">#&gt;   B-spline degree:   2</span></span>
<span><span class="co">#&gt;   Basis d.o.f.:  999</span></span>
<span><span class="va">Q_m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_gmrf.html" class="external-link">fm_matern_precision</a></span><span class="op">(</span><span class="va">m</span>, alpha <span class="op">=</span> <span class="fl">2</span>, rho <span class="op">=</span> <span class="fl">0.3</span>, sigma <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">Q_m_dense</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_gmrf.html" class="external-link">fm_matern_precision</a></span><span class="op">(</span><span class="va">m_dense</span>, alpha <span class="op">=</span> <span class="fl">2</span>, rho <span class="op">=</span> <span class="fl">0.3</span>, sigma <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">Q_m_dense2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_gmrf.html" class="external-link">fm_matern_precision</a></span><span class="op">(</span><span class="va">m_dense2</span>, alpha <span class="op">=</span> <span class="fl">2</span>, rho <span class="op">=</span> <span class="fl">0.3</span>, sigma <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/geom_fm.html" class="external-link">geom_fm</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">m</span>,</span>
<span>    mappings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"m"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    weights <span class="op">=</span> <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_gmrf.html" class="external-link">fm_sample</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">Q_m</span><span class="op">)</span>,</span>
<span>    knots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    basis <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/geom_fm.html" class="external-link">geom_fm</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">m_dense</span>,</span>
<span>    mappings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"m_dense"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    weights <span class="op">=</span> <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_gmrf.html" class="external-link">fm_sample</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">Q_m_dense</span><span class="op">)</span>,</span>
<span>    knots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    basis <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/geom_fm.html" class="external-link">geom_fm</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">m_dense2</span>,</span>
<span>    mappings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"m_dense2"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    weights <span class="op">=</span> <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_gmrf.html" class="external-link">fm_sample</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">Q_m_dense2</span><span class="op">)</span>,</span>
<span>    knots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    basis <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="lecture_notes_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">m_dense2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_mesh_1d.html" class="external-link">fm_mesh_1d</a></span><span class="op">(</span></span>
<span>  loc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>,</span>
<span>  degree <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; fm_mesh_1d object:</span></span>
<span><span class="co">#&gt;   Manifold:  R1</span></span>
<span><span class="co">#&gt;   #{knots}:  1000</span></span>
<span><span class="co">#&gt;   Interval:  (0, 1)</span></span>
<span><span class="co">#&gt;   Boundary:  (neumann, neumann)</span></span>
<span><span class="co">#&gt;   B-spline degree:   2</span></span>
<span><span class="co">#&gt;   Basis d.o.f.:  999</span></span>
<span><span class="va">Q_m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_gmrf.html" class="external-link">fm_matern_precision</a></span><span class="op">(</span><span class="va">m</span>, alpha <span class="op">=</span> <span class="fl">1</span>, rho <span class="op">=</span> <span class="fl">0.3</span>, sigma <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">Q_m_dense</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_gmrf.html" class="external-link">fm_matern_precision</a></span><span class="op">(</span><span class="va">m_dense</span>, alpha <span class="op">=</span> <span class="fl">1</span>, rho <span class="op">=</span> <span class="fl">0.3</span>, sigma <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">Q_m_dense2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_gmrf.html" class="external-link">fm_matern_precision</a></span><span class="op">(</span><span class="va">m_dense2</span>, alpha <span class="op">=</span> <span class="fl">1</span>, rho <span class="op">=</span> <span class="fl">0.3</span>, sigma <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/geom_fm.html" class="external-link">geom_fm</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">m</span>,</span>
<span>    mappings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"m"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    weights <span class="op">=</span> <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_gmrf.html" class="external-link">fm_sample</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">Q_m</span><span class="op">)</span>,</span>
<span>    knots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    basis <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/geom_fm.html" class="external-link">geom_fm</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">m_dense</span>,</span>
<span>    mappings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"m_dense"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    weights <span class="op">=</span> <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_gmrf.html" class="external-link">fm_sample</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">Q_m_dense</span><span class="op">)</span>,</span>
<span>    knots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    basis <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/geom_fm.html" class="external-link">geom_fm</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">m_dense2</span>,</span>
<span>    mappings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"m_dense2"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    weights <span class="op">=</span> <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_gmrf.html" class="external-link">fm_sample</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">Q_m_dense2</span><span class="op">)</span>,</span>
<span>    knots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    basis <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="lecture_notes_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
</div>
</div>
<div class="section level3">
<h3 id="d">2D<a class="anchor" aria-label="anchor" href="#d"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_mesh_2d.html" class="external-link">fm_mesh_2d</a></span><span class="op">(</span></span>
<span>  boundary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_nonconvex_hull_inla.html" class="external-link">fm_nonconvex_hull_inla</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, convex <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  max.edge <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; fm_mesh_2d object:</span></span>
<span><span class="co">#&gt;   Manifold:  R2</span></span>
<span><span class="co">#&gt;   V / E / T: 233 / 642 / 410</span></span>
<span><span class="co">#&gt;   Euler char.:   1</span></span>
<span><span class="co">#&gt;   Constraints:   Boundary: 54 boundary edges (1 group: 1), Interior: 0 edges</span></span>
<span><span class="co">#&gt;   Bounding box: (-4.996242, 4.996242) x (-4.996242, 4.996242)</span></span>
<span><span class="co">#&gt;   Basis d.o.f.:  233</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/geom_fm.html" class="external-link">geom_fm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">m</span><span class="op">)</span></span></code></pre></div>
<p><img src="lecture_notes_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_mesh_2d.html" class="external-link">fm_mesh_2d</a></span><span class="op">(</span></span>
<span>  boundary <span class="op">=</span> <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_nonconvex_hull.html" class="external-link">fm_extensions</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, convex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  max.edge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; fm_mesh_2d object:</span></span>
<span><span class="co">#&gt;   Manifold:  R2</span></span>
<span><span class="co">#&gt;   V / E / T: 1002 / 2961 / 1960</span></span>
<span><span class="co">#&gt;   Euler char.:   1</span></span>
<span><span class="co">#&gt;   Constraints:   Boundary: 42 boundary edges (1 group: 1), Interior: 88 interior edges (1 group: 1)</span></span>
<span><span class="co">#&gt;   Bounding box: (-9.999247, 9.999247) x (-9.999247, 9.999247)</span></span>
<span><span class="co">#&gt;   Basis d.o.f.:  1002</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/geom_fm.html" class="external-link">geom_fm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">m2</span><span class="op">)</span></span></code></pre></div>
<p><img src="lecture_notes_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bnd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_nonconvex_hull.html" class="external-link">fm_extensions</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, convex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_mesh_2d.html" class="external-link">fm_mesh_2d</a></span><span class="op">(</span></span>
<span>  loc <span class="op">=</span> <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_hexagon_lattice.html" class="external-link">fm_hexagon_lattice</a></span><span class="op">(</span><span class="va">bnd</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, edge_len <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  boundary <span class="op">=</span> <span class="va">bnd</span>,</span>
<span>  max.edge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; fm_mesh_2d object:</span></span>
<span><span class="co">#&gt;   Manifold:  R2</span></span>
<span><span class="co">#&gt;   V / E / T: 602 / 1764 / 1163</span></span>
<span><span class="co">#&gt;   Euler char.:   1</span></span>
<span><span class="co">#&gt;   Constraints:   Boundary: 39 boundary edges (1 group: 1), Interior: 74 interior edges (1 group: 1)</span></span>
<span><span class="co">#&gt;   Bounding box: (-9.999247, 9.999247) x (-9.999247, 9.999247)</span></span>
<span><span class="co">#&gt;   Basis d.o.f.:  602</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/geom_fm.html" class="external-link">geom_fm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">m3</span><span class="op">)</span></span></code></pre></div>
<p><img src="lecture_notes_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="observations">Observations<a class="anchor" aria-label="anchor" href="#observations"></a>
</h2>
<div class="section level3">
<h3 id="coupling-latent-variables-to-observations">Coupling latent variables to observations<a class="anchor" aria-label="anchor" href="#coupling-latent-variables-to-observations"></a>
</h3>
<p>While observations are almost always finite-dimensional, the latent
variables and random effects are often infinite-dimensional, at least
conceptually. This means that we need to be careful about how we link
the observations to the latent variables. The benefit of this way of
thinking is that it allows us to link misaligned observation structures
to the same latent models, and we can jointly model different types of
observations without necessarily having to adapt the latent
structures.</p>
</div>
<div class="section level3">
<h3 id="pointgeoreferenced-data">Point/Georeferenced data<a class="anchor" aria-label="anchor" href="#pointgeoreferenced-data"></a>
</h3>
<p>Classical geostatistical models with additive Gaussian noise: <span class="math display">\[
y_i = \eta(s_i) + \epsilon_i
\]</span></p>
<p>Poisson counts at given locations: <span class="math display">\[
y_i \sim \text{Po}(e^{\eta(s_i)} ds)
\]</span></p>
</div>
<div class="section level3">
<h3 id="arealaggregated-data">Areal/aggregated data<a class="anchor" aria-label="anchor" href="#arealaggregated-data"></a>
</h3>
<p>If our observations were constructed by aggregation over a region
<span class="math inline">\(B_i\)</span>, we need to determine how the
aggregated values link to the continuous domain predictor.</p>
<p>For an averaged predictor with additive Gaussian noise: <span class="math display">\[
y_i = \frac{1}{|B_i|}\int_{B_i} \eta(s) ds + \epsilon_i
\]</span> If our data consists of sums of Poisson counts at different
locations, we get <span class="math display">\[
y_{B_j} = \#\{i; s_i\in B_j\} \sim \text{Po}\left(\sum_{s_i\in B_j}
e^{\eta(s_i)}\right)
\]</span> Note that this is not the same as aggregating the linear
predictor itself, due to the nonlinear transformation. Also note that
the situation is much more complicated for non-Poisson count models,
since for example the sum of two independent Binomial variables, <span class="math inline">\(\text{Bin}(n_1, p_1)+\text{Bin}(n_2, p_2)\)</span>
is not itself Binomial unless <span class="math inline">\(p_1=p_2\)</span>.</p>
<p>If our data consists of counts of Poisson process point pattern data
<span class="math inline">\(\{s_i;i=1\dots,N(\Omega)\}\)</span>,
aggregated to regions <span class="math inline">\(B_j\)</span>, we can
use the following model, directly based on the properties of a Posson
point process. <span class="math display">\[
y_{B_j} = \#\{i; s_i\in B_j\} \sim \text{Po}\left(\int_{B_j} e^{\eta(s)}
\,ds\right)
\]</span></p>
</div>
<div class="section level3">
<h3 id="point-pattern-data">Point pattern data<a class="anchor" aria-label="anchor" href="#point-pattern-data"></a>
</h3>
<p>A Poisson point process is a random process that generates points in
space such that the count of points in any given set <span class="math inline">\(B\)</span> is Poisson distributed with expectation
<span class="math inline">\(\Lambda(B)=\int_B \lambda(s)\,ds\)</span>,
where <span class="math inline">\(\lambda(s)\)</span> is the intensity
function. Log-Gaussian Cox processes are obtained with <span class="math inline">\(\lambda(s)=e^{\eta(s)}\)</span> when <span class="math inline">\(\eta(s)\)</span> is a Gaussian random field. A
Poisson process point pattern on a sampling region <span class="math inline">\(\Omega\)</span> is a set with conditional
distribution <span class="math display">\[
\{s_i;s_i\in \Omega\} \sim \text{PoPr}\left(e^{\eta(\cdot)}\right)
\]</span> This means that for every set <span class="math inline">\(B\subseteq\Omega\)</span>, <span class="math display">\[
\#\{s_i;s_i\in B\} \sim \text{Po}\left(\int_B e^{\eta(s)}\,ds\right) .
\]</span></p>
</div>
</div>
<div class="section level2">
<h2 id="latent-gaussian-models-for-geostatistics">Latent Gaussian models for geostatistics<a class="anchor" aria-label="anchor" href="#latent-gaussian-models-for-geostatistics"></a>
</h2>
<p>INLA implements models where each observation <span class="math inline">\(y_i\)</span> is linked to an element of a linear
predictor vector, <span class="math inline">\(\eta_i\)</span>, that
typically controls the location parameter of the observation model,
through a link function <span class="math inline">\(g(\cdot)\)</span>,
with conditional independence, given <span class="math inline">\(\eta\)</span>.</p>
<p>The linear predictor</p>
<div class="section level3">
<h3 id="spatial-covariates">Spatial covariates<a class="anchor" aria-label="anchor" href="#spatial-covariates"></a>
</h3>
</div>
<div class="section level3">
<h3 id="independent-random-effects">Independent random effects<a class="anchor" aria-label="anchor" href="#independent-random-effects"></a>
</h3>
</div>
<div class="section level3">
<h3 id="structured-random-effects">Structured random effects<a class="anchor" aria-label="anchor" href="#structured-random-effects"></a>
</h3>
</div>
<div class="section level3">
<h3 id="coupling-latent-models-to-several-types-of-data">Coupling latent models to several types of data<a class="anchor" aria-label="anchor" href="#coupling-latent-models-to-several-types-of-data"></a>
</h3>
</div>
</div>
<div class="section level2">
<h2 id="inlabru-model-structure">
<code>inlabru</code> model structure<a class="anchor" aria-label="anchor" href="#inlabru-model-structure"></a>
</h2>
<div class="section level3">
<h3 id="classic-inla">Classic INLA<a class="anchor" aria-label="anchor" href="#classic-inla"></a>
</h3>
<p>Classic <code>INLA</code> model formulas are designed to closely
follow basic additive model formula syntax, such as</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">response</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">covariate1</span> <span class="op">+</span> <span class="va">covariate2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/INLA/man/f.html" class="external-link">f</a></span><span class="op">(</span><span class="va">field</span>, model <span class="op">=</span> <span class="va">model_name</span><span class="op">)</span></span></code></pre></div>
<p>This defines a model with a linear predictor of the form <span class="math display">\[
\eta_i = \beta_0 + \beta_1 x_{i,1} + \beta_2 x_{i,2} + u_i
\]</span> where <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span>, and <span class="math inline">\(\beta_2\)</span> are independent Gaussian scalars,
and <span class="math inline">\(u_i\)</span> is an unstructured or
structured latent Gaussian random effect.</p>
<p>For <code><a href="https://rdrr.io/pkg/INLA/man/f.html" class="external-link">INLA::f()</a></code> components, the name of the input variable
also becomes the name of the effect.</p>
<p>For spatial models, the <code>field</code> variable would need to be
defined as an index into the mesh nodes, usually constructed with
<code><a href="https://rdrr.io/pkg/INLA/man/inla.spde.make.index.html" class="external-link">inla.spde.make.index()</a></code>, and <code><a href="https://rdrr.io/pkg/INLA/man/inla.spde.make.A.html" class="external-link">inla.spde.make.A()</a></code>
and <code><a href="https://rdrr.io/pkg/INLA/man/inla.stack.html" class="external-link">inla.stack()</a></code> used to construct the mapping information
required to inform INLA about how the nodes are linked to the
observations.</p>
<p>One of the aims of <code>inlabru</code> is to provide a more compact
and flexible syntax for defining models, by automatically handling the
mapping between structured latent variables and observations.</p>
<p>If you’ve used the “raw” INLA approach, please consult <a href="https://inlabru-org.github.io/inlabru/articles/mesh_mapping.html" class="external-link">Converting
<code>inla.spde.make.A</code> calls into the <code>bru_mapper</code>
system</a>.</p>
</div>
<div class="section level3">
<h3 id="inlabru">inlabru<a class="anchor" aria-label="anchor" href="#inlabru"></a>
</h3>
<p><code>inlabru</code> uses a conceptual information flow for model
definition:</p>
<ul>
<li>latent model components</li>
<li>component effects</li>
<li>predictor expressions</li>
<li>observation models</li>
</ul>
<div class="section level4">
<h4 id="model-components-and-effects">Model components and effects<a class="anchor" aria-label="anchor" href="#model-components-and-effects"></a>
</h4>
<p>Model components are defined in a way that decouples the input data
names from the effect of each model component. This allows the same
variable to be involved in several components, without the need for
creating dummies and copies.</p>
<p>Each component takes a general R expression as input, which is
evaluated in the context of the observation model data. The
<code><a href="https://inlabru-org.github.io/inlabru/reference/bru_mapper.html" class="external-link">bru_mapper()</a></code> system is used to construct per-component
model matrices, which are then combined into a joint model matrix based
on the predictor expressions.</p>
<p>The basic syntax is
<code>effect_name(input_variable, model = ...)</code>, which defines an
effect of the input variable, using the specified model. The model can
be any INLA model, such as <code>"iid"</code>, <code>"ar1"</code>,
<code>"rw2"</code>, <code>"bym2"</code>, a
<code><a href="https://rdrr.io/pkg/INLA/man/inla.spde2.pcmatern.html" class="external-link">inla.spde2.pcmatern()</a></code> model object, or a user-defined model
(rgeneric/cgeneric). The standard INLA models have default mappers
associated with them, and a user-defined model can be associated with a
mapper using a <code><a href="https://inlabru-org.github.io/inlabru/reference/bru_get_mapper.html" class="external-link">bru_get_mapper()</a></code> method, or explicitly
provided by the user.</p>
<p>The default input expression is the name of the components, so that
classical effects can be written as <code>+ covar</code>, which is
shorthand for <code>+ covar(covar, model = "linear")</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">response</span> <span class="op">~</span> <span class="fu">Intercept</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">covariate1</span> <span class="op">+</span></span>
<span>  <span class="va">covariate2</span> <span class="op">+</span></span>
<span>  <span class="fu">field</span><span class="op">(</span><span class="va">geometry</span>, model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/INLA/man/inla.spde2.pcmatern.html" class="external-link">inla.spde2.pcmatern</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Here, the component effect is called <code>field</code>, the input is
the <code>geometry</code> variable from <code>sf</code> data, and the
mapper is an automatically constructed <code><a href="https://inlabru-org.github.io/inlabru/reference/bru_mapper_fmesher.html" class="external-link">bru_mapper_fmesher()</a></code>
mapper for the mesh used in the <code>model</code> definition.</p>
<p>There are two kinds of mappers; Non-indexed mappers provide raw
covariate values as input to <code><a href="https://rdrr.io/pkg/INLA/man/f.html" class="external-link">INLA::f()</a></code>, which is used for
fixed effects and <code>rw1</code>/<code>rw2</code> models. Indexed
mappers are used to build models on integers or categories.</p>
<p>For more details on component definitions, see <a href="https://inlabru-org.github.io/inlabru/articles/component.html" class="external-link">Defining
model components</a> and the in-depth discussion of the mapper system,
including how to define more complex fixed effects components
(<code>model="fixed"</code> together with
<code><a href="https://inlabru-org.github.io/inlabru/reference/bru_mapper_matrix.html" class="external-link">bru_mapper_matrix()</a></code> )and custom mappers, <a href="https://inlabru-org.github.io/inlabru/articles/bru_mapper.html" class="external-link">Customised
model components with the <code>bru_mapper</code> system</a>.</p>
</div>
<div class="section level4">
<h4 id="predictor-expressions">Predictor expressions<a class="anchor" aria-label="anchor" href="#predictor-expressions"></a>
</h4>
<p>For compatibility with basic glm formulas, <code>inlabru</code> by
default constructs a predictor expression that adds all the component
effects, with the response variable named to the left of the
<code>~</code> operator. The following code,</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://inlabru-org.github.io/inlabru/reference/bru.html" class="external-link">bru</a></span><span class="op">(</span></span>
<span>  <span class="va">response</span> <span class="op">~</span> <span class="fu">Intercept</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">covariate1</span> <span class="op">+</span></span>
<span>    <span class="va">covariate2</span> <span class="op">+</span></span>
<span>    <span class="fu">field</span><span class="op">(</span><span class="va">geometry</span>, model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/INLA/man/inla.spde2.pcmatern.html" class="external-link">inla.spde2.pcmatern</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>is equivalent to</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://inlabru-org.github.io/inlabru/reference/bru.html" class="external-link">bru</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span> <span class="fu">Intercept</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">covariate1</span> <span class="op">+</span></span>
<span>    <span class="va">covariate2</span> <span class="op">+</span></span>
<span>    <span class="fu">field</span><span class="op">(</span><span class="va">geometry</span>, model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/INLA/man/inla.spde2.pcmatern.html" class="external-link">inla.spde2.pcmatern</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://inlabru-org.github.io/inlabru/reference/bru_obs.html" class="external-link">bru_obs</a></span><span class="op">(</span></span>
<span>    <span class="va">response</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>    <span class="va">...</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>where <code>~ .</code> is a shorthand for a complete additive model.
To limit which variables should be added, one can use the
<code>used</code> argument to <code><a href="https://inlabru-org.github.io/inlabru/reference/bru_obs.html" class="external-link">bru_obs()</a></code> to specify a
particular component subset.</p>
<p>In version <code>2.12.0</code>, specifying an explicit expression
instead of the <code>~ .</code> shorthand would cause the predictor to
be interpreted as a non-linear expression, and activate the iterative
linearisation method. From <code>2.12.0.9014</code>, purely additive
expressions, such as <code>response ~ Intercept + field</code>, are
detected automatically.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="non-linear-predictors-and-mappers">Non-linear predictors and mappers<a class="anchor" aria-label="anchor" href="#non-linear-predictors-and-mappers"></a>
</h2>
<p><code>inlabru</code> provides a flexible framework for defining
non-linear predictors through arbitrary R expressions, as well as
applying nonlinear transformations to the model component effects
directly.</p>
<p>For non-linear predictor models, inlabru uses an iterative
linearisation method. The non-linear predictor <span class="math inline">\(\widetilde{\eta}(u)\)</span> is replaced by a
linear approximation <span class="math inline">\(\overline{\eta}^*(u) =
b + A u\)</span>, constructed at the current best conditional posterior
mode, <span class="math inline">\(u^*\)</span>. An INLA run yields a new
candidate point <span class="math inline">\(\widehat{u}\)</span>. The
next linearisation point is chosen by line-search, <span class="math display">\[
\gamma = \arg\min_\gamma \left\| \widetilde{\eta}^*\left((1-\gamma) u^*
+ \gamma \widehat{u}\right) -
\overline{\eta}^*(\widehat{u})\right\|_\text{(weighted by posterior
variances)}
\]</span> defining a new linearisation point <span class="math inline">\(u^*_\text{new}=(1-\gamma) u^* + \gamma
\widehat{u}\)</span>. The linearisation is repeated until convergence,
i.e. when the changes in <span class="math inline">\(u^*\)</span> are
small in relation to the posterior standard deviations.</p>
<p>Use <code>bru_convergence_plot(fit)</code> to see post-run
convergence diagnostics, which can reveal potential problems and aid
debugging.</p>
<div class="section level3">
<h3 id="non-linear-expressions">Non-linear expressions<a class="anchor" aria-label="anchor" href="#non-linear-expressions"></a>
</h3>
<p>A simple example is to use the <code><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp()</a></code> function to model a
positive additive effect:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comp</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="fu">beta0</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu">field</span><span class="op">(</span><span class="va">geometry</span>, model <span class="op">=</span> <span class="va">matern</span><span class="op">)</span></span>
<span><span class="va">form</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">~</span> <span class="va">beta0</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">field</span><span class="op">)</span></span></code></pre></div>
<p>This can be particularly useful in multi-observation models with
common effects:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comp</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span></span>
<span>  <span class="fu">beta0_A</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">beta0_B</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">beta_field_B</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">field</span><span class="op">(</span><span class="va">geometry</span>, model <span class="op">=</span> <span class="va">matern</span><span class="op">)</span></span>
<span><span class="va">form_A</span> <span class="op">&lt;-</span> <span class="va">y_A</span> <span class="op">~</span> <span class="va">beta0_A</span> <span class="op">+</span> <span class="va">field</span></span>
<span><span class="va">form_B</span> <span class="op">&lt;-</span> <span class="va">y_B</span> <span class="op">~</span> <span class="va">beta0_B</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">beta_field_B</span><span class="op">)</span> <span class="op">*</span> <span class="va">field</span></span></code></pre></div>
<p>For this type of scaling parameter, one should normally use a more
specific prior distribution for <code>beta_field_B</code>, which can be
done using a component marginal transformation mapper, see below.</p>
</div>
<div class="section level3">
<h3 id="non-linear-mappers">Non-linear mappers<a class="anchor" aria-label="anchor" href="#non-linear-mappers"></a>
</h3>
<div class="section level4">
<h4 id="aggregation">Aggregation<a class="anchor" aria-label="anchor" href="#aggregation"></a>
</h4>
<p><code><a href="https://inlabru-org.github.io/inlabru/reference/bru_mapper_aggregate.html" class="external-link">bru_mapper_aggregate()</a></code> and
<code><a href="https://inlabru-org.github.io/inlabru/reference/bru_mapper_logsumexp.html" class="external-link">bru_mapper_logsumexp()</a></code> are aggregation mappers for linear
and nonlinear aggregation functions, respectively, with averaging or
total sum/integral aggregation. From <code>inlabru</code> version
<code>2.12.0.9013</code>, the first method can be used to construct all
four aggregation types, via
<code>bru_mapper_aggregate(type = ...)</code></p>
<p>When transforming interactively or in expressions, it may be
preferable to call the core <code>fmesher</code> functions
<code><a href="https://inlabru-org.github.io/fmesher/reference/fm_block.html" class="external-link">fm_block_eval()</a></code> and <code><a href="https://inlabru-org.github.io/fmesher/reference/fm_block.html" class="external-link">fm_block_logsumexp_eval()</a></code>
directly instead of having to create an explicit mapper object and
calling <code>ibm_eval(mapper, ...)</code>.</p>
</div>
<div class="section level4">
<h4 id="marginal-transformations">Marginal transformations<a class="anchor" aria-label="anchor" href="#marginal-transformations"></a>
</h4>
<p>To transform <span class="math inline">\(N(0,1)\)</span> variables
marginally to other distributions, we can use the
<code><a href="https://inlabru-org.github.io/inlabru/reference/bru_mapper_marginal.html" class="external-link">bru_mapper_marginal()</a></code> mapper. This applies careful
numerical transformations and computes the Jacobian of the
transformation, so that the predictor linearisation can compute the
overall linearised mapping between latent variables and observations
using the chain rule.</p>
<p>The following defines a <code>beta_field_B</code> component with
effect distributed as <span class="math inline">\(\text{Exp}(1)\)</span>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comp</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span></span>
<span>  <span class="fu">beta0_A</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">beta0_B</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">beta_field_B</span><span class="op">(</span><span class="fl">1</span>,</span>
<span>    prec.linear <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    marginal <span class="op">=</span> <span class="fu"><a href="https://inlabru-org.github.io/inlabru/reference/bru_mapper_marginal.html" class="external-link">bru_mapper_marginal</a></span><span class="op">(</span><span class="va">qexp</span>, rate <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">field</span><span class="op">(</span><span class="va">geometry</span>, model <span class="op">=</span> <span class="va">matern</span><span class="op">)</span></span>
<span><span class="va">form_A</span> <span class="op">&lt;-</span> <span class="va">y_A</span> <span class="op">~</span> <span class="va">beta0_A</span> <span class="op">+</span> <span class="va">field</span></span>
<span><span class="va">form_B</span> <span class="op">&lt;-</span> <span class="va">y_B</span> <span class="op">~</span> <span class="va">beta0_B</span> <span class="op">+</span> <span class="va">beta_field_B</span> <span class="op">*</span> <span class="va">field</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="model-assessment">Model assessment<a class="anchor" aria-label="anchor" href="#model-assessment"></a>
</h2>
<div class="section level3">
<h3 id="posterior-predictive-checks">Posterior predictive checks<a class="anchor" aria-label="anchor" href="#posterior-predictive-checks"></a>
</h3>
<p>While global model diagnostic scores such as DIC and WAIC can be
useful for basic model comparison, they are often not very informative
about in what way one model might be better or worse than another, and
lack interpretability, in particular about the spatial behavior of the
model.</p>
<p>A more informative approach is to use posterior predictive checks,
where we can compute both overall scores and spatially resolved
scores.</p>
<p>For a general introduction to how to compute posterior observation
level prediction scores, see the <code>inlabru</code> package vignette
on <a href="https://inlabru-org.github.io/inlabru/articles/prediction_scores.html" class="external-link">Prediction
scores</a></p>
<div class="section level4">
<h4 id="proper-scoring-rules">Proper scoring rules<a class="anchor" aria-label="anchor" href="#proper-scoring-rules"></a>
</h4>
<p>Posterior samples can be used to compute proper scoring rules. For
each (new) observation <span class="math inline">\(y_i\)</span> and
posterior predictive model <span class="math inline">\(F_i\)</span>, a
proper score <span class="math inline">\(S(F,y)\)</span> is a function
of the posterior predictive distribution <span class="math inline">\(F\)</span> and the observation <span class="math inline">\(y\)</span> such that if <span class="math inline">\(G\)</span> is the true predictive distribution,
the expectation <span class="math inline">\(S(F,G)=E_{y\sim
G}[S(F,y)]\)</span> fulfils <span class="math inline">\(S(F,G)\geq
S(G,G)\)</span>, i.e. on average, the score is minimized when the
predictive distribution is equal to the true distribution. The score is
strictly proper if equality is obtained only when <span class="math inline">\(F=G\)</span>.</p>
<p>Generally easy to compute/estimate:</p>
<ul>
<li>Squared Error: <span class="math inline">\(S_\text{SE}(F,y)=[y -
E_F(y)]^2\)</span>
</li>
<li>Dawid-Sebastiani: <span class="math inline">\(S_\text{DS}(F,y)=\frac{[y -
E_F(y)]^2}{V_F(y)}+\log[V_F(y)]\)</span>
</li>
<li>Log-score: <span class="math inline">\(S_\text{LS}(F,y)=-\log
p_F(y)\)</span>
</li>
</ul>
<p>More difficult to compute/estimate:</p>
<ul>
<li>Absolute Error: <span class="math inline">\(S_\text{AE}(F,y)=\left|y
- \text{median}_F(y)\right|\)</span>
</li>
<li>CRPS: <span class="math inline">\(S_\text{CRPS}(F,y)=\int_\mathbb{R}
\left[F(x) - \mathbb{I}(y\leq x)\right]^2 \,dx\)</span>
</li>
</ul>
<p>The average prediction scores are defined by <span class="math display">\[
\overline{S}(\{F_i\},\{y_i\}) = \frac{1}{N}\sum_{i=1}^N S(F_i,y_i)
\]</span> where <span class="math inline">\(N\)</span> is the number of
prediction observations.</p>
<p>When comparing models A and B, one should work with the collection of
individual score differences, since the scores <span class="math inline">\(S(F_i^A,y_i)\)</span> and <span class="math inline">\(S(F_i^B,y_i)\)</span> are dependent, and we need
to treat them as paired samples.</p>
<p>We define <span class="math display">\[
S_\Delta(F_i^A,F_i^B,y_i) = S(F_i^B,y_i) - S(F_i^A,y_i)
\]</span> and get <span class="math display">\[
V\left[\overline{S}(\{F_i^B\},\{y_i\}) -
\overline{S}(\{F_i^B\},\{y_i\})\right] \approx
\frac{1}{N} V\left[S(F_i^B,y_i) - S(F_i^A,y_i)\right]
\]</span></p>
</div>
</div>
<div class="section level3">
<h3 id="point-process-residuals">Point process residuals<a class="anchor" aria-label="anchor" href="#point-process-residuals"></a>
</h3>
<p>See the <code>inlabru</code> package vignette on <a href="https://inlabru-org.github.io/inlabru/articles/2d_lgcp_residuals_sf.html" class="external-link">Residual
Analysis of spatial point process models using Bayesian methods</a></p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-bachl2019inlabru" class="csl-entry">
Bachl, Fabian E., Finn Lindgren, David L. Borchers, and Janine B.
Illian. 2019. <span>“<span class="nocase">inlabru</span>: An
<span>R</span> Package for <span>Bayesian</span> Spatial Modelling from
Ecological Survey Data.”</span> <em>Methods in Ecology and
Evolution</em> 10: 760–66. <a href="https://doi.org/10.1111/2041-210X.13168" class="external-link">https://doi.org/10.1111/2041-210X.13168</a>.
</div>
<div id="ref-lindgren2024spacetime" class="csl-entry">
Lindgren, F., H. Bakka, D. Bolin, E. Krainski, and H. Rue. 2024.
<span>“A Diffusion-Based Spatio-Temporal Extension of Gaussian Matérn
Fields.”</span> <em>SORT</em> 48 (1). <a href="https://raco.cat/index.php/SORT/article/view/428665" class="external-link">https://raco.cat/index.php/SORT/article/view/428665</a>.
</div>
<div id="ref-lindgren2024inlabrusoftwarefittinglatent" class="csl-entry">
Lindgren, Finn, Fabian Bachl, Janine Illian, Man Ho Suen, Håvard Rue,
and Andrew E. Seaton. 2024. <span>“Inlabru: Software for Fitting Latent
Gaussian Models with Non-Linear Predictors.”</span> <a href="https://arxiv.org/abs/2407.00791" class="external-link">https://arxiv.org/abs/2407.00791</a>.
</div>
<div id="ref-lindgren2022spde10years" class="csl-entry">
Lindgren, Finn, David Bolin, and Håvard Rue. 2022. <span>“The SPDE
Approach for Gaussian and Non-Gaussian Fields: 10 Years and Still
Running.”</span> <em>Spatial Statistics</em> 50: 100599. <a href="https://doi.org/doi.org/10.1016/j.spasta.2022.100599" class="external-link">https://doi.org/doi.org/10.1016/j.spasta.2022.100599</a>.
</div>
<div id="ref-lindgren2011spde" class="csl-entry">
Lindgren, Finn, Håvard Rue, and Johan Lindström. 2011. <span>“An
Explicit Link Between Gaussian Fields and Gaussian Markov Random Fields:
The Stochastic Partial Differential Equation Approach.”</span>
<em>Journal of the Royal Statistical Society Series B: Statistical
Methodology</em> 73 (4): 423–98. <a href="https://doi.org/10.1111/j.1467-9868.2011.00777.x" class="external-link">https://doi.org/10.1111/j.1467-9868.2011.00777.x</a>.
</div>
<div id="ref-rue2009inla" class="csl-entry">
Rue, Håvard, Sara Martino, and Nicolas Chopin. 2009. <span>“Approximate
Bayesian Inference for Latent Gaussian Models by Using Integrated Nested
Laplace Approximations.”</span> <em>Journal of the Royal Statistical
Society: Series B (Statistical Methodology)</em> 71 (2): 319–92. <a href="https://doi.org/10.1111/j.1467-9868.2008.00700.x" class="external-link">https://doi.org/10.1111/j.1467-9868.2008.00700.x</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Finn Lindgren.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
